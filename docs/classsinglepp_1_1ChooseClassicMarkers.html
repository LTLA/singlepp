<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>singlepp: singlepp::ChooseClassicMarkers Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">singlepp
   </div>
   <div id="projectbrief">A C++ library for cell type classification</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesinglepp.html">singlepp</a></li><li class="navelem"><a class="el" href="classsinglepp_1_1ChooseClassicMarkers.html">ChooseClassicMarkers</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="classsinglepp_1_1ChooseClassicMarkers-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">singlepp::ChooseClassicMarkers Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Classic method for choosing markers.  
 <a href="classsinglepp_1_1ChooseClassicMarkers.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ChooseClassicMarkers_8hpp_source.html">ChooseClassicMarkers.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsinglepp_1_1ChooseClassicMarkers_1_1Defaults.html">Defaults</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default parameter settings.  <a href="structsinglepp_1_1ChooseClassicMarkers_1_1Defaults.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a03e250433489457e4a10dcd92e22b7be"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classsinglepp_1_1ChooseClassicMarkers.html">ChooseClassicMarkers</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsinglepp_1_1ChooseClassicMarkers.html#a03e250433489457e4a10dcd92e22b7be">set_number</a> (int n=<a class="el" href="structsinglepp_1_1ChooseClassicMarkers_1_1Defaults.html#a79db7259e0d4f07f77651b76ef2d8ff3">Defaults::number</a>)</td></tr>
<tr class="separator:a03e250433489457e4a10dcd92e22b7be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a714ba00e4d43d666ee5f66fed78d3e50"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classsinglepp_1_1ChooseClassicMarkers.html">ChooseClassicMarkers</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsinglepp_1_1ChooseClassicMarkers.html#a714ba00e4d43d666ee5f66fed78d3e50">set_num_threads</a> (int n=<a class="el" href="structsinglepp_1_1ChooseClassicMarkers_1_1Defaults.html#a2c4b81fd9d8eb79e2a3d47c6d2f935f2">Defaults::num_threads</a>)</td></tr>
<tr class="separator:a714ba00e4d43d666ee5f66fed78d3e50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9c977f369dbe3a7321a3e9d2781bbd2"><td class="memTemplParams" colspan="2">template&lt;class Matrix , typename Label &gt; </td></tr>
<tr class="memitem:aa9c977f369dbe3a7321a3e9d2781bbd2"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespacesinglepp.html#ae39cf61993000d182cb3464b4ace1406">Markers</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classsinglepp_1_1ChooseClassicMarkers.html#aa9c977f369dbe3a7321a3e9d2781bbd2">run</a> (const std::vector&lt; const Matrix * &gt; &amp;representatives, const std::vector&lt; const Label * &gt; &amp;labels) const</td></tr>
<tr class="separator:aa9c977f369dbe3a7321a3e9d2781bbd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1716234b8f8d11cbec8f24557fa55629"><td class="memTemplParams" colspan="2">template&lt;class Matrix &gt; </td></tr>
<tr class="memitem:a1716234b8f8d11cbec8f24557fa55629"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespacesinglepp.html#ae39cf61993000d182cb3464b4ace1406">Markers</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classsinglepp_1_1ChooseClassicMarkers.html#a1716234b8f8d11cbec8f24557fa55629">run</a> (const Matrix *representative, const int *labels) const</td></tr>
<tr class="separator:a1716234b8f8d11cbec8f24557fa55629"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:aaa9f0ce7ba6a2aff369cc01e152ba821"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsinglepp_1_1ChooseClassicMarkers.html#aaa9f0ce7ba6a2aff369cc01e152ba821">number_of_markers</a> (int nlabels)</td></tr>
<tr class="separator:aaa9f0ce7ba6a2aff369cc01e152ba821"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Classic method for choosing markers. </p>
<p >This class implements the classic <b>SingleR</b> method for choosing markers from (typically bulk) reference dataasets. We assume that we have a matrix of representative log-expression profiles for each label, typically computed by taking some average across all reference profiles for that label. For the comparison between labels A and B, we define the marker set as the top genes with the largest positive differences in A's profile over B (i.e., the log-fold change). The number of top genes can either be explicitly specified or it can be automatically determined from the number of labels.</p>
<p >If multiple references are present, we compute the sum of the log-fold changes across all references with both labels A and B. The ordering of the top genes is then performed using the sum across references. It is assumed that all references have the same number and ordering of features in their rows. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="aaa9f0ce7ba6a2aff369cc01e152ba821" name="aaa9f0ce7ba6a2aff369cc01e152ba821"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa9f0ce7ba6a2aff369cc01e152ba821">&#9670;&nbsp;</a></span>number_of_markers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int singlepp::ChooseClassicMarkers::number_of_markers </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlabels</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nlabels</td><td>Number of labels in the reference(s).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An appropriate number of markers for each pairwise comparison.</dd></dl>
<p>The exact expression is defined as $500 (\frac{2}{3})^{\log_2{N}}$ for $N$ labels, which steadily decreases the markers per comparison as the number of labels increases. This aims to avoid an excessive number of features when dealing with references with many labels. </p>

</div>
</div>
<a id="a1716234b8f8d11cbec8f24557fa55629" name="a1716234b8f8d11cbec8f24557fa55629"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1716234b8f8d11cbec8f24557fa55629">&#9670;&nbsp;</a></span>run() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Matrix &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacesinglepp.html#ae39cf61993000d182cb3464b4ace1406">Markers</a> singlepp::ChooseClassicMarkers::run </td>
          <td>(</td>
          <td class="paramtype">const Matrix *&#160;</td>
          <td class="paramname"><em>representative</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int *&#160;</td>
          <td class="paramname"><em>labels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Matrix</td><td>A <b>tatami</b> matrix.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">representative</td><td>A representative matrix, containing one column per label. Each column should have a representative log-expression profile for that label. </td></tr>
    <tr><td class="paramname">labels</td><td>Pointer to an array of length equal to the number of columns in <code>representative</code>. Each value of the array should specify the label for the corresponding column. Values should lie in $[0, N)$ for $N$ unique labels.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <code>Markers</code> object containing the top markers for each pairwise comparison between labels. </dd></dl>

</div>
</div>
<a id="aa9c977f369dbe3a7321a3e9d2781bbd2" name="aa9c977f369dbe3a7321a3e9d2781bbd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9c977f369dbe3a7321a3e9d2781bbd2">&#9670;&nbsp;</a></span>run() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Matrix , typename Label &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacesinglepp.html#ae39cf61993000d182cb3464b4ace1406">Markers</a> singlepp::ChooseClassicMarkers::run </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; const Matrix * &gt; &amp;&#160;</td>
          <td class="paramname"><em>representatives</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; const Label * &gt; &amp;&#160;</td>
          <td class="paramname"><em>labels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname">Matrix</td><td>A <b>tatami</b> matrix. </td></tr>
    <tr><td class="paramname">Label</td><td>Integer type for the label identity.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">representatives</td><td>Vector of representative matrices. Each matrix should contain one column per label; each column should have a representative log-expression profile for that label. All matrices should have the same number of rows, corresponding to the same features. </td></tr>
    <tr><td class="paramname">labels</td><td>Vector of pointers of length equal to <code>representatives</code>. Each array should be of length equal to the number of columns of the corresponding entry of <code>representatives</code>. Each value of the array should specify the label for the corresponding column in its matrix. Values should lie in $[0, N)$ for $N$ unique labels across all entries of <code>labels</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <code>Markers</code> object containing the top markers for each pairwise comparison between labels. </dd></dl>

</div>
</div>
<a id="a714ba00e4d43d666ee5f66fed78d3e50" name="a714ba00e4d43d666ee5f66fed78d3e50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a714ba00e4d43d666ee5f66fed78d3e50">&#9670;&nbsp;</a></span>set_num_threads()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classsinglepp_1_1ChooseClassicMarkers.html">ChooseClassicMarkers</a> &amp; singlepp::ChooseClassicMarkers::set_num_threads </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em> = <code><a class="el" href="structsinglepp_1_1ChooseClassicMarkers_1_1Defaults.html#a2c4b81fd9d8eb79e2a3d47c6d2f935f2">Defaults::num_threads</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of threads to use.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classsinglepp_1_1ChooseClassicMarkers.html" title="Classic method for choosing markers.">ChooseClassicMarkers</a></code> object. </dd></dl>

</div>
</div>
<a id="a03e250433489457e4a10dcd92e22b7be" name="a03e250433489457e4a10dcd92e22b7be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03e250433489457e4a10dcd92e22b7be">&#9670;&nbsp;</a></span>set_number()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classsinglepp_1_1ChooseClassicMarkers.html">ChooseClassicMarkers</a> &amp; singlepp::ChooseClassicMarkers::set_number </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em> = <code><a class="el" href="structsinglepp_1_1ChooseClassicMarkers_1_1Defaults.html#a79db7259e0d4f07f77651b76ef2d8ff3">Defaults::number</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>Number of top genes to use as the marker set in each pairwise comparison. If -1, this is automatically determined from the number of labels, see <code><a class="el" href="classsinglepp_1_1ChooseClassicMarkers.html#aaa9f0ce7ba6a2aff369cc01e152ba821">number_of_markers()</a></code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A reference to this <code><a class="el" href="classsinglepp_1_1ChooseClassicMarkers.html" title="Classic method for choosing markers.">ChooseClassicMarkers</a></code> object. </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>singlepp/<a class="el" href="ChooseClassicMarkers_8hpp_source.html">ChooseClassicMarkers.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
